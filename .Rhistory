q()
library(HandyCNV)
setwd("/Users/luciabazan/Documents/GitHub/cnv_sgdp")
calls <- read.csv('data/chm13_cnvranger_input.csv', as.is=TRUE)
cnv_standard <- cnv_clean(standard_cnv = calls, #when running your own data, set this argument by 'standard_cnv = "localpath/file"'
drop_length = 5, #the maximum CNV length threshold (in Mb); CNVs larger than this value will be deleted
folder = "cnv_clean_chm13")
cnv_summary_plot(clean_cnv = cnv_standard, #standard file was generated by 'cnv_clean' function in section 1
length_group = c(0.05, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 1, 2, 5), # optional, set group of vectors to divide CNV length, unit is Mb. such as vector of ‘c(0.05, 0.3, 1)’, means divide the CNV length into four group: '<0.05Mb', '0.05 - 0.3Mb', '0.3-1Mb' and '>1Mb', maximum can accept 11 valueses
col_0 = "red", #optional, customize color for o copy CNV
col_1 = "black", #optional, customize color for o copy CNV
col_3 = "purple", #optional, customize color for o copy CNV
col_4 = "blue", #optional, customize color for o copy CNV
plot_sum_1 = TRUE,  #optional, make sum combination plot 1
height_sum1 = 26, #optional, adjust the size of sum plot 1
width_sum1 = 20, #optional, adjust the size of sum plot 1
plot_sum_2 = TRUE, #optional, make sum combination plot 2
height_sum2 = 20, #optional, adjust the size of sum plot 2
width_sum2 = 27, #optional, adjust the size of sum plot 2
folder = "cnv_summary_plot_chm13")
cnvr_plot(cnvr = "call_cnvr_chm13/cnvr.txt", #standard file was generated by 'call_cnvr' function in section 4
assembly = "ARS", #cattle could select 'UMD' or 'ARS', other species could assign the name of species
loss_col = "green2", #optional, adjust the color of Loss type of CNVR
gain_col = "red", #optional, adjust the color of Gain type of CNVR
mixed_col = "black",  #optional, adjust the color of Mixed type of CNVR
legend_x = 127, #optional, adjust the horizontal position of legend
legend_y = 30,  #optional, adjust the vertical position of legend
#height_1 = 14, #optional, adjust the height of CNVR plot
#width_1 = 10, #optional, adjust the width of CNVR plot
folder = "cnvr_plot_penn")
