q()
library(CNVRanger)
library(CNVRanger)
library(AnnotationHub)
setwd("/Users/luciabazan/Documents/GitHub/cnv_sgdp")
read.table("../call_cnvr_cnvnator/individual_cnv_cnvr.txt")
read.table("call_cnvr_cnvnator/individual_cnv_cnvr.txt")
read.table("call_cnvr_cnvnator/individual_cnv_cnvr.txt")
read.csv("call_cnvr_cnvnator/individual_cnv_cnvr.txt")
read.csv("call_cnvr_cnvnator/individual_cnv_cnvr.txt", sep = "\t")
calls <- read.csv("call_cnvr_cnvnator/individual_cnv_cnvr.txt", sep = "\t")
nrow(calls)
drop_na(calls)
library(tidyr)
drop_na(calls)
calls <- read.csv("call_cnvr_cnvnator/individual_cnv_cnvr.txt", sep = "\t")
calls <-  drop_na(calls)
nrow(calls)
grl <- GenomicRanges::makeGRangesListFromDataFrame(calls,
split.field="Sample_id", keep.extra.columns=TRUE)
grl <- GenomicRanges::makeGRangesListFromDataFrame(calls,
split.field="Sample_ID", keep.extra.columns=TRUE)
grl
grl <- GenomicRanges::sort(grl)
grl
ra <- RaggedExperiment::RaggedExperiment(grl)
ra
cnvrs <- populationRanges(grl, density=0.1)
calls  %>%
rename(
CNV_Value = state,
)
calls  %>%
rename(
state = CNV_Value,
)
names(calls)[names(calls) == "CNV_Value"] <- "state"
grl <- GenomicRanges::makeGRangesListFromDataFrame(calls,
split.field="Sample_ID", keep.extra.columns=TRUE)
grl
# SORT
grl <- GenomicRanges::sort(grl)
grl
# CNVR
cnvrs <- populationRanges(grl, density=0.1)
cnvrs
ro.cnvrs <- populationRanges(grl[1:100], mode="RO", ro.thresh=0.51)
cnvrs <- populationRanges(grl, density=0.1, est.recur=TRUE)
subset(cnvrs, pvalue < 0.05)
View(calls)
plotRecurrentRegions(cnvrs, genome="bosTau6", chr="chr1")
library(Gviz)
BiocManager::install("Gviz")
library(Gviz)
tidyverse_update(recursive = FALSE, repos = getOption("repos"))
install.packages("tidyverse")
library(Gviz)
library(tidyselect)
library(dplyr)
library(tidyr)
detach("package:dplyr", unload = TRUE)
library(dplyr)
library(CNVRanger)
library(tidyr)
library(Gviz)
plotRecurrentRegions(cnvrs, genome="bosTau6", chr="chr1")
library(AnnotationHub)
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("AnnotationHub")
library(AnnotationHub)
